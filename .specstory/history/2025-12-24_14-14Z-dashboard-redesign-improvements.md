<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session 82a83a69-fde6-4240-a786-f456f451047e (2025-12-24 14:14Z) -->

# Dashboard redesign improvements (2025-12-24 14:14Z)

_**User (2025-12-24 13:31Z)**_

here redesign this dashboard to make it more clean, actionable, showcasing something real. 

IMPORTANT:
* DO NOT HARDCODE ANYTHING
* PERSIAN/DARI IS DEFAULT 
* ROBUST AND CLEAR VIEW IS PRIORITY

---

_**Agent (model gemini-3-pro-preview, mode Plan)**_

<think><details><summary>Thought Process</summary>
**Revising Dashboard Concepts**

I've been contemplating the dashboard revamp. My immediate focus is on understanding the existing implementation and identifying the available data. I'm aiming for a "clean, actionable" design that highlights actual, tangible results. The challenge lies in translating the raw data into insightful, user-friendly visualizations.


**Planning the Redesign**

I'm now formulating a plan for the redesign. I'll begin by analyzing the existing file structure, focusing on identifying the dashboard's rendering logic and data retrieval mechanisms. Subsequently, I'll examine the image provided to understand the current presentation. This groundwork will allow me to create wireframes and propose a dashboard that is clean, actionable, and reflects real-world results.


**Investigating Implementation Details**

I'm deep in the codebase now, tracing the dashboard's rendering process. I'm focusing on the data flow, trying to pinpoint where the data for those key "cards" is fetched and formatted. I've begun by listing files and scanning for potential HTML/PHP files related to the dashboard, and am also looking into the API endpoints.


</details></think>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** â€¢ Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** â€¢ Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** â€¢ Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Assessing the Project's Structure**

I'm currently focusing on the project's architecture. The directory layout is becoming clearer. It seems the backend is built with PHP, with all the api-related files located in the `api/` directory. The frontend leverages HTML, CSS, and JavaScript in the `public/` folder. The `setup.php` file intrigues me; I'm trying to determine its role, maybe for setup or initialization.


**Delving into the Frontend**

Now, I'm examining `public/index.html` to understand the dashboard's initial structure. I suspect this is the primary entry point after user login. Simultaneously, I will look through the `public/js/app.js` file and likely other JavaScript files to understand the data fetching mechanisms. To get more context, I also want to check the files in the `api/` directory, especially focusing on `api/reports.php`, `api/accounting.php`, and `api/students.php`.


</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: public/index.html</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Defining Data Sources**

I've been mapping the data sources for the dashboard. Right now, it's pulling student counts (total and active) from `students.php`. Then there's the `accounting.php` script, which provides net income data, filtered by month and year. Next steps involve analyzing data validation at each source.


**Examining Current Data Retrieval**

I'm now fully dissecting the data retrieval process. Specifically, the dashboard grabs total and active student counts from `students.php`, as well as net income data, filtered by date, from `accounting.php`.  I'm also mapping how the "expiring" alerts are currently handled. Currently, the `loadDashboard` function handles the orchestration.


**Exploring API Data Availability**

I'm presently examining the API files for data that can support the redesigned dashboard. I'm focusing on `accounting.php` for historical income data and `students.php` for recent registrations, hoping to populate charts and a "recent activities" section. I'll also check `reports.php` to see if there are other data sources to utilize. I've begun to build the potential list of dashboard improvements.


</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: api/accounting.php</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: api/students.php</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: api/reports.php</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Defining Data Points**

I'm currently focused on defining the key data points I'll need. Right now, I'm noting the sources for financial figures, specifically net income, expenses, and revenue, pulled from `api/accounting.php` by month. I've also identified the endpoint for student counts: `api/students.php`, which provides both total and active student numbers.


**Gathering API Endpoints**

Now I am cataloging the data sources. I have pinpointed the accounting endpoint and confirmed its monthly income and expenses data. Also, the student API provides student counts and a list of expiring students. Finally, I've confirmed that the 'breakdown' action and the 'reports' endpoint will be incredibly useful for providing recent activity and monthly summaries.


**Mapping The Data Flow**

I'm now detailing how the data will flow within the dashboard. The `reports.php` endpoint seems the most versatile, providing monthly overviews. I intend to use it for charting. Also, I think `accounting.php?action=breakdown` and `students.php?action=expiring` will work well as the source for "Recent Activity" and "Expiring Soon" respectively.


**Planning the Redesign**

Now I'm crafting the redesign plan. I'll modify `public/index.html` for a grid layout and `public/js/app.js` to fetch data and populate the new sections. I plan to add "Recent Transactions" and enhance the "Expiring" section. Chart.js will be my charting choice, and I can't wait to test this.


**Formulating a Proposal**

I'm now formulating a plan for the redesign, detailing specific changes to `index.html` and `app.js`. The focus is on implementing a grid layout and incorporating new sections for recent transactions and expiring students. I'm exploring Chart.js for visualizations and considering how to efficiently fetch data from existing API endpoints, emphasizing ease of implementation and minimal API changes. I'll propose modifying the layout and enhancing `app.js`. I will check existing CSS classes.


</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: public/css/design-system.css</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Reviewing the Framework**

I'm presently examining the design system's architecture, specifically the established classes. I've noted the availability of elements such as `card-app`, `kpi-card`, and `table-app`, which appears promising. My preliminary design involves redesigning the public index.html page, incorporating Chart.js via CDN.


**Assessing the Components**

I'm now diving deeper into the available components. The `btn-app` class just caught my eye, and I'm thinking I can leverage it for the "Quick Actions" section on the redesigned index page. Regarding the chart, I've decided to keep it simple, given the API constraints, and will proceed with a straightforward bar chart to visualize income versus expenses for the current month.


**Defining the Scope**

I've made significant progress by finalizing the plan. The redesign of `index.html` is now clearer, with the layout structure defined. Also, the plan to modify `app.js`, including fetching data and initializing charts, is solid. I've switched from a static bar chart to a dynamic line chart to show income versus expenses over the last 30 days. The data will be extracted, grouped, and visualized using a chart. I'm checking the `jalali.js` library for date processing.


</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: public/js/jalali.js</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Defining the Structure**

\n\n

I'm currently focused on the front-end layout. I'm planning the structure of the `index.html` file. Specifically, I'm integrating Chart.js and organizing the content with KPI cards at the top. I've got the overall structure in mind now. Next step is probably implementing the chart.


**Structuring the Plan**

\n\n

I've fleshed out the plan now, including a breakdown of the `index.html` structure with KPI cards and charts. I'm focusing on integrating Chart.js and fetching data from `api/accounting.php`. I also need to ensure that the authentication process is still working correctly.


**Finalizing the Strategy**

\n\n

I've just finalized the implementation plan. I'll modify `index.html` to incorporate KPI cards, a line chart, recent registrations, and expiring items, utilizing Chart.js and `design-system.css`. I'll update `app.js` to fetch accounting data, populate the table, and initialize the chart with Jalali dates. I've re-verified the `api/accounting.php` response structure and confirmed auth is intact. I'm ready to begin implementation.


</details></think>

---

<tool-use data-tool-type="unknown" data-tool-name="create_plan">
<details>
<summary>Tool use: **create_plan**</summary>


Parameters:

```json
{
  "plan": "# Dashboard Redesign Plan\n\nI will transform the current dashboard into a modern, data-rich view using the existing design system and API.\n\n## 1. Structure &amp; Layout\nI will update &#96;[public/index.html](public/index.html)&#96; to use a grid-based layout:\n- **Top Row (KPIs)**: 4 Key metrics (Total Students, Active Students, Monthly Revenue, Net Income).\n- **Middle Row (Analytics &amp; Actions)**:\n    - **Left (2/3)**: **Financial Trend Chart** (Income vs Expenses for the current month).\n    - **Right (1/3)**: **Quick Actions** (Register Student, Add Expense, etc.).\n- **Bottom Row (Activity)**:\n    - **Left (1/2)**: **Recent Registrations** (Table showing last 5 registrations with student names and amounts).\n    - **Right (1/2)**: **Expiring Soon** (List of students expiring in the next 7 days).\n\n## 2. Implementation Details\n\n### Frontend (&#96;[public/index.html](public/index.html)&#96;)\n- Add **Chart.js** via CDN for the financial chart.\n- Re-structure the HTML to use Bootstrap's grid system more effectively.\n- Use &#96;design-system.css&#96; classes for consistent styling.\n\n### Logic (&#96;[public/js/app.js](public/js/app.js)&#96; &amp; Inline Script)\n- **Data Fetching**:\n    - Fetch &#96;api/accounting.php?action=breakdown&#96; to get detailed transaction data for the chart and \"Recent Registrations\" list.\n    - Process this data in JavaScript to group by date for the chart.\n- **Charts**:\n    - Implement a Line Chart showing \"Income\" and \"Expenses\" over the days of the current Jalali month.\n- **Recent Activity**:\n    - Populate the \"Recent Registrations\" table dynamically.\n\n## 3. Why this approach?\n- **No new PHP/API code needed**: We use &#96;api/accounting.php?action=breakdown&#96; which already provides the raw data.\n- **\"Real\" &amp; \"Actionable\"**: The chart shows actual financial trends, and the recent list shows real activity, not just static numbers.\n- **Robust**: Uses the existing robust &#96;design-system.css&#96;.\n- **Persian/RTL**: Fully supports the existing RTL direction and Persian labels.\n",
  "name": "Redesign Dashboard with Charts &amp; Better Layout",
  "todos": [
    {
      "content": "Modify public/index.html to implement the new grid layout and include Chart.js",
      "status": "pending",
      "id": "layout"
    },
    {
      "content": "Update dashboard JavaScript to fetch breakdown data and render the Chart.js chart",
      "status": "pending",
      "id": "js-logic",
      "dependencies": [
        "layout"
      ]
    },
    {
      "content": "Implement Recent Registrations table and Quick Actions section",
      "status": "pending",
      "id": "recent-actions",
      "dependencies": [
        "layout"
      ]
    }
  ],
  "overview": "I will redesign the dashboard to be cleaner and more actionable by introducing a grid layout, a financial trend chart, and real-time recent activity tables, using existing API endpoints."
}
```
Additional data:

```json
{
  "reviewData": {
    "status": "Requested",
    "selectedOption": "none",
    "isShowingInput": false
  },
  "planUri": "file:///home/ahmadi/.cursor/plans/redesign_dashboard_with_charts_%26_better_layout_0462d7f8.plan.md",
  "hasOpenedEditor": true
}
```
Result:

```json
{
  "accepted": {
    "finalTodos": [
      {
        "content": "Modify public/index.html to implement the new grid layout and include Chart.js",
        "status": "pending",
        "id": "layout"
      },
      {
        "content": "Update dashboard JavaScript to fetch breakdown data and render the Chart.js chart",
        "status": "pending",
        "id": "js-logic"
      },
      {
        "content": "Implement Recent Registrations table and Quick Actions section",
        "status": "pending",
        "id": "recent-actions"
      }
    ]
  },
  "planUri": "/home/ahmadi/.cursor/plans/redesign_dashboard_with_charts_&amp;_better_layout_0462d7f8.plan.md"
}
```
Status: **completed**


</details>
</tool-use>

---

_**User (2025-12-24 13:31Z)**_

Implement the plan as specified, it is attached for your reference. Do NOT edit the plan file itself.

To-do's from the plan have already been created. Do not create them again. Mark them as in_progress as you work, starting with the first one. Don't stop until you have completed all the to-dos.

---

_**Agent (model gemini-3-pro-preview, mode Agent)**_

<think><details><summary>Thought Process</summary>
**Implementing the Redesign Plan**

I've begun working on the dashboard redesign. I've marked the first task, related to the layout, as in progress. Next, I'm planning to implement the new grid layout within `public/index.html` and include Chart.js for data visualization. After that, I will update the logic for the existing javascript.


**Reviewing API Endpoints**

I'm now diving deeper into the API endpoints. I need to understand how `api/accounting.php` returns the data for the financial trend chart and the recent registrations table. I'm specifically looking at the `handleGetBreakdown` function in `api/accounting.php` to analyze the data structure it provides.


**Revisiting Data Endpoints**

Now I'm revisiting the API strategy. I've confirmed that `api/accounting.php?action=breakdown` provides both income and expense data needed for the financial trend chart and the recent registrations table. I also confirmed that  `api/students.php?action=expiring` is the correct endpoint for "Expiring Soon". I am checking  `api/students.php` for total and active student count.


**Commencing HTML Revisions**

I'm now focused on updating `public/index.html`. I've analyzed the API endpoints and have a clear data fetching strategy. The next step is to replace the existing layout in `<main>` with the new grid layout. After that, I will include Chart.js and begin to connect the JavaScript.


</details></think>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** â€¢ Todo List</summary>

- [-] Modify public/index.html to implement the new grid layout and include Chart.js
- [ ] Update dashboard JavaScript to fetch breakdown data and render the Chart.js chart
- [ ] Implement Recent Registrations table and Quick Actions section

</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="write">

<details><summary>Tool use: **write** â€¢ Edit file: public/index.html</summary>

**Chunk 1**
Lines added: 674, lines removed: 458

```diff
@@ -9,460 +9,676 @@
      &lt;link rel="stylesheet" href="css/design-system.css"&gt;
      &lt;link rel="stylesheet" href="css/custom.css"&gt;
- &lt;/head&gt;
- &lt;body&gt;
-     &lt;!-- Navigation --&gt;
-     &lt;nav class="navbar-app"&gt;
-         &lt;a class="navbar-brand" href="index.html"&gt;
-             &lt;span class="navbar-brand-icon"&gt;ğŸ¤¸â€â™‚ï¸&lt;/span&gt;
-             Ú©Ù…Ù¾ Ø®Ø±Ø§Ø³Ø§Ù†
-         &lt;/a&gt;
-         
-         &lt;ul class="navbar-nav-app"&gt;
-             &lt;li&gt;&lt;a class="nav-link-app active" href="index.html"&gt;Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯&lt;/a&gt;&lt;/li&gt;
-             &lt;li&gt;&lt;a class="nav-link-app" href="students.html"&gt;Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†&lt;/a&gt;&lt;/li&gt;
-             &lt;li&gt;&lt;a class="nav-link-app" href="coaches.html"&gt;Ù…Ø±Ø¨ÛŒØ§Ù†&lt;/a&gt;&lt;/li&gt;
-             &lt;li&gt;&lt;a class="nav-link-app" href="expenses.html"&gt;Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§&lt;/a&gt;&lt;/li&gt;
-             &lt;li&gt;&lt;a class="nav-link-app" href="rent.html"&gt;Ø§Ø¬Ø§Ø±Ù‡&lt;/a&gt;&lt;/li&gt;
-             &lt;li&gt;&lt;a class="nav-link-app" href="accounting.html"&gt;Ø¯Ø±Ø¢Ù…Ø¯ Ø®Ø§Ù„Øµ&lt;/a&gt;&lt;/li&gt;
-             &lt;li&gt;&lt;a class="nav-link-app" href="reports.html"&gt;Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§&lt;/a&gt;&lt;/li&gt;
-             &lt;li id="adminNavItem" style="display: none;"&gt;
-                 &lt;a class="nav-link-app" href="admin.html"&gt;Ù…Ø¯ÛŒØ±&lt;/a&gt;
-             &lt;/li&gt;
-         &lt;/ul&gt;
-         
-         &lt;div class="navbar-actions"&gt;
-             &lt;!-- Theme Toggle Switch --&gt;
-             &lt;button type="button" class="theme-switch" id="themeSwitch" title="ØªØºÛŒÛŒØ± ØªÙ…"&gt;
-                 &lt;span class="theme-switch-icons"&gt;
-                     &lt;span class="theme-switch-icon theme-switch-icon--sun"&gt;â˜€ï¸&lt;/span&gt;
-                     &lt;span class="theme-switch-icon theme-switch-icon--moon"&gt;ğŸŒ™&lt;/span&gt;
-                 &lt;/span&gt;
-                 &lt;span class="theme-switch-slider"&gt;&lt;/span&gt;
-             &lt;/button&gt;
-             
-             &lt;!-- User Info --&gt;
-             &lt;div class="navbar-user"&gt;
-                 &lt;span class="navbar-user-icon"&gt;&lt;i class="bi bi-person"&gt;&lt;/i&gt;&lt;/span&gt;
-                 &lt;span id="userName"&gt;&lt;/span&gt;
-             &lt;/div&gt;
-             
-             &lt;!-- Logout --&gt;
-             &lt;button class="navbar-logout" onclick="logout()"&gt;
-                 &lt;i class="bi bi-box-arrow-right"&gt;&lt;/i&gt;
-                 &lt;span&gt;Ø®Ø±ÙˆØ¬&lt;/span&gt;
-             &lt;/button&gt;
-         &lt;/div&gt;
-         
-         &lt;!-- Mobile Menu Toggle --&gt;
-         &lt;button class="navbar-mobile-toggle" id="mobileMenuToggle"&gt;
-             &lt;i class="bi bi-list"&gt;&lt;/i&gt;
-         &lt;/button&gt;
-     &lt;/nav&gt;
- 
-     &lt;!-- Sidebar --&gt;
-     &lt;aside class="sidebar-app" id="sidebar"&gt;
-         &lt;nav class="sidebar-nav"&gt;
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="index.html" class="sidebar-nav-link active"&gt;
-                     &lt;i class="bi bi-grid-1x2 sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             
-             &lt;div class="sidebar-section-title"&gt;Ù…Ø¯ÛŒØ±ÛŒØª&lt;/div&gt;
-             
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="students.html" class="sidebar-nav-link"&gt;
-                     &lt;i class="bi bi-people sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="students.html?tab=new" class="sidebar-nav-link"&gt;
-                     &lt;i class="bi bi-person-plus sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ø«Ø¨Øª Ø¬Ø¯ÛŒØ¯
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="coaches.html" class="sidebar-nav-link"&gt;
-                     &lt;i class="bi bi-person-badge sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ù…Ø±Ø¨ÛŒØ§Ù†
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             
-             &lt;div class="sidebar-section-title"&gt;Ù…Ø§Ù„ÛŒ&lt;/div&gt;
-             
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="expenses.html" class="sidebar-nav-link"&gt;
-                     &lt;i class="bi bi-cash-stack sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="rent.html" class="sidebar-nav-link"&gt;
-                     &lt;i class="bi bi-house sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ø§Ø¬Ø§Ø±Ù‡
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="accounting.html" class="sidebar-nav-link"&gt;
-                     &lt;i class="bi bi-calculator sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ø¯Ø±Ø¢Ù…Ø¯ Ø®Ø§Ù„Øµ
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="reports.html" class="sidebar-nav-link"&gt;
-                     &lt;i class="bi bi-bar-chart sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             
-             &lt;div class="sidebar-section-title"&gt;Ø³ÛŒØ³ØªÙ…&lt;/div&gt;
-             
-             &lt;div class="sidebar-nav-item" id="adminSidebarItem" style="display: none;"&gt;
-                 &lt;a href="admin.html" class="sidebar-nav-link"&gt;
-                     &lt;i class="bi bi-gear sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ù…Ø¯ÛŒØ±
-                 &lt;/a&gt;
-             &lt;/div&gt;
-             &lt;div class="sidebar-nav-item"&gt;
-                 &lt;a href="#" class="sidebar-nav-link" onclick="logout()"&gt;
-                     &lt;i class="bi bi-box-arrow-right sidebar-nav-icon"&gt;&lt;/i&gt;
-                     Ø®Ø±ÙˆØ¬
-                 &lt;/a&gt;
-             &lt;/div&gt;
-         &lt;/nav&gt;
-     &lt;/aside&gt;
- 
-     &lt;!-- Main Content --&gt;
-     &lt;main class="app-main"&gt;
-         &lt;div class="container-app"&gt;
-             &lt;!-- Page Header --&gt;
-             &lt;div class="flex items-center justify-between mb-6"&gt;
-                 &lt;h1 class="page-title mb-0"&gt;Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯&lt;/h1&gt;
-                 &lt;div class="text-secondary" id="currentDate"&gt;&lt;/div&gt;
-             &lt;/div&gt;
- 
-             &lt;!-- KPI Cards Row 1 --&gt;
-             &lt;div class="row g-4 mb-4"&gt;
-                 &lt;div class="col-sm-6 col-xl-3"&gt;
-                     &lt;div class="kpi-card kpi-card--primary animate-slideUp"&gt;
-                         &lt;div class="kpi-card-icon"&gt;
-                             &lt;i class="bi bi-people"&gt;&lt;/i&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-value" id="totalStudents"&gt;
-                             &lt;div class="skeleton skeleton-title" style="width: 80px; height: 36px;"&gt;&lt;/div&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-label"&gt;Ú©Ù„ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†&lt;/div&gt;
-                         &lt;a href="students.html" class="kpi-card-link"&gt;
-                             Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ù…Ù‡
-                             &lt;i class="bi bi-arrow-left"&gt;&lt;/i&gt;
-                         &lt;/a&gt;
-                     &lt;/div&gt;
-                 &lt;/div&gt;
-                 
-                 &lt;div class="col-sm-6 col-xl-3"&gt;
-                     &lt;div class="kpi-card kpi-card--success animate-slideUp" style="animation-delay: 50ms;"&gt;
-                         &lt;div class="kpi-card-icon"&gt;
-                             &lt;i class="bi bi-person-check"&gt;&lt;/i&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-value" id="activeStudents"&gt;
-                             &lt;div class="skeleton skeleton-title" style="width: 80px; height: 36px;"&gt;&lt;/div&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-label"&gt;Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† ÙØ¹Ø§Ù„ Ø§ÛŒÙ† Ù…Ø§Ù‡&lt;/div&gt;
-                     &lt;/div&gt;
-                 &lt;/div&gt;
-                 
-                 &lt;div class="col-sm-6 col-xl-3"&gt;
-                     &lt;div class="kpi-card kpi-card--info animate-slideUp" style="animation-delay: 100ms;"&gt;
-                         &lt;div class="kpi-card-icon"&gt;
-                             &lt;i class="bi bi-cash-coin"&gt;&lt;/i&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-value" id="totalRevenue"&gt;
-                             &lt;div class="skeleton skeleton-title" style="width: 100px; height: 36px;"&gt;&lt;/div&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-label"&gt;Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ù„ (Ø§ÙØºØ§Ù†ÛŒ)&lt;/div&gt;
-                     &lt;/div&gt;
-                 &lt;/div&gt;
-                 
-                 &lt;div class="col-sm-6 col-xl-3"&gt;
-                     &lt;div class="kpi-card kpi-card--warning animate-slideUp" style="animation-delay: 150ms;"&gt;
-                         &lt;div class="kpi-card-icon"&gt;
-                             &lt;i class="bi bi-receipt"&gt;&lt;/i&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-value" id="totalExpenses"&gt;
-                             &lt;div class="skeleton skeleton-title" style="width: 100px; height: 36px;"&gt;&lt;/div&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-label"&gt;Ú©Ù„ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ (Ø§ÙØºØ§Ù†ÛŒ)&lt;/div&gt;
-                     &lt;/div&gt;
-                 &lt;/div&gt;
-             &lt;/div&gt;
- 
-             &lt;!-- KPI Cards Row 2 --&gt;
-             &lt;div class="row g-4 mb-6"&gt;
-                 &lt;div class="col-sm-6 col-xl-3"&gt;
-                     &lt;div class="kpi-card kpi-card--dark animate-slideUp" style="animation-delay: 200ms;"&gt;
-                         &lt;div class="kpi-card-icon"&gt;
-                             &lt;i class="bi bi-graph-up-arrow"&gt;&lt;/i&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-value" id="netIncome"&gt;
-                             &lt;div class="skeleton skeleton-title" style="width: 100px; height: 36px;"&gt;&lt;/div&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-label"&gt;Ø¯Ø±Ø¢Ù…Ø¯ Ø®Ø§Ù„Øµ (Ø§ÙØºØ§Ù†ÛŒ)&lt;/div&gt;
-                     &lt;/div&gt;
-                 &lt;/div&gt;
-                 
-                 &lt;div class="col-sm-6 col-xl-3"&gt;
-                     &lt;div class="kpi-card kpi-card--danger animate-slideUp" style="animation-delay: 250ms;"&gt;
-                         &lt;div class="kpi-card-icon"&gt;
-                             &lt;i class="bi bi-exclamation-triangle"&gt;&lt;/i&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-value" id="expiringCount"&gt;
-                             &lt;div class="skeleton skeleton-title" style="width: 60px; height: 36px;"&gt;&lt;/div&gt;
-                         &lt;/div&gt;
-                         &lt;div class="kpi-card-label"&gt;Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ ØªÙ…Ø¯ÛŒØ¯&lt;/div&gt;
-                         &lt;a href="students.html?tab=expiring" class="kpi-card-link"&gt;
-                             Ù…Ø´Ø§Ù‡Ø¯Ù‡
-                             &lt;i class="bi bi-arrow-left"&gt;&lt;/i&gt;
-                         &lt;/a&gt;
-                     &lt;/div&gt;
-                 &lt;/div&gt;
-             &lt;/div&gt;
- 
-             &lt;!-- Quick Actions --&gt;
-             &lt;div class="card-app mb-6 animate-slideUp" style="animation-delay: 300ms;"&gt;
-                 &lt;div class="card-app-header"&gt;
-                     &lt;h2 class="card-app-title"&gt;
-                         &lt;i class="bi bi-lightning-charge"&gt;&lt;/i&gt;
-                         Ø¯Ø³ØªØ±Ø³ÛŒ Ø³Ø±ÛŒØ¹
-                     &lt;/h2&gt;
-                 &lt;/div&gt;
-                 &lt;div class="card-app-body"&gt;
-                     &lt;div class="quick-actions"&gt;
-                         &lt;a href="students.html?tab=new" class="quick-action-card"&gt;
-                             &lt;div class="quick-action-icon" style="background: var(--color-primary-50); color: var(--color-primary-600);"&gt;
-                                 &lt;i class="bi bi-person-plus"&gt;&lt;/i&gt;
-                             &lt;/div&gt;
-                             &lt;span class="quick-action-label"&gt;Ø«Ø¨Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø¬Ø¯ÛŒØ¯&lt;/span&gt;
-                         &lt;/a&gt;
-                         
-                         &lt;a href="coaches.html" class="quick-action-card"&gt;
-                             &lt;div class="quick-action-icon" style="background: var(--color-success-50); color: var(--color-success-600);"&gt;
-                                 &lt;i class="bi bi-person-badge"&gt;&lt;/i&gt;
-                             &lt;/div&gt;
-                             &lt;span class="quick-action-label"&gt;Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø±Ø¨ÛŒØ§Ù†&lt;/span&gt;
-                         &lt;/a&gt;
-                         
-                         &lt;a href="expenses.html" class="quick-action-card"&gt;
-                             &lt;div class="quick-action-icon" style="background: var(--color-warning-50); color: var(--color-warning-600);"&gt;
-                                 &lt;i class="bi bi-cash-stack"&gt;&lt;/i&gt;
-                             &lt;/div&gt;
-                             &lt;span class="quick-action-label"&gt;Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡&lt;/span&gt;
-                         &lt;/a&gt;
-                         
-                         &lt;a href="accounting.html" class="quick-action-card"&gt;
-                             &lt;div class="quick-action-icon" style="background: #ecfeff; color: #0891b2;"&gt;
-                                 &lt;i class="bi bi-calculator"&gt;&lt;/i&gt;
-                             &lt;/div&gt;
-                             &lt;span class="quick-action-label"&gt;Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø±Ø¢Ù…Ø¯&lt;/span&gt;
-                         &lt;/a&gt;
-                     &lt;/div&gt;
-                 &lt;/div&gt;
-             &lt;/div&gt;  
- 
-             &lt;!-- Alerts Section --&gt;
-             &lt;div class="card-app animate-slideUp" style="animation-delay: 350ms;"&gt;
-                 &lt;div class="card-app-header" style="background: linear-gradient(135deg, var(--color-warning-500) 0%, var(--color-warning-600) 100%);"&gt;
-                     &lt;h2 class="card-app-title text-dark"&gt;
-                         &lt;i class="bi bi-bell"&gt;&lt;/i&gt;
-                         Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§
-                     &lt;/h2&gt;
-                 &lt;/div&gt;
-                 &lt;div class="card-app-body" id="alertsContainer"&gt;
-                     &lt;!-- Loading skeleton --&gt;
-                     &lt;div class="skeleton skeleton-text" style="width: 100%;"&gt;&lt;/div&gt;
-                     &lt;div class="skeleton skeleton-text" style="width: 80%;"&gt;&lt;/div&gt;
-                 &lt;/div&gt;
-             &lt;/div&gt;
-         &lt;/div&gt;
-     &lt;/main&gt;
- 
-     &lt;!-- Mobile Sidebar Overlay --&gt;
-     &lt;div class="sidebar-overlay" id="sidebarOverlay"&gt;&lt;/div&gt;
- 
-     &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
-     &lt;script src="js/app.js"&gt;&lt;/script&gt;
-     &lt;script src="js/jalali.js?v=2"&gt;&lt;/script&gt;
-     &lt;script&gt;
-         // Check authentication
-         const user = JSON.parse(localStorage.getItem('user') || 'null');
-         if (!user) {
-             window.location.href = 'login.html';
-         } else {
-             document.getElementById('userName').textContent = user.username;
-             // Show Admin tab if user is admin
-             if (user.role === 'admin') {
-                 document.getElementById('adminNavItem').style.display = 'block';
-                 document.getElementById('adminSidebarItem').style.display = 'block';
-             }
-         }
- 
-         // Display current Jalali date
-         function displayCurrentDate() {
-             const now = new Date();
-             const jalali = gregorianToJalali(now.getFullYear(), now.getMonth() + 1, now.getDate());
-             const monthNames = ['Ø­Ù…Ù„', 'Ø«ÙˆØ±', 'Ø¬ÙˆØ²Ø§', 'Ø³Ø±Ø·Ø§Ù†', 'Ø§Ø³Ø¯', 'Ø³Ù†Ø¨Ù„Ù‡', 'Ù…ÛŒØ²Ø§Ù†', 'Ø¹Ù‚Ø±Ø¨', 'Ù‚ÙˆØ³', 'Ø¬Ø¯ÛŒ', 'Ø¯Ù„Ùˆ', 'Ø­ÙˆØª'];
-             const monthName = monthNames[jalali.month - 1];
-             document.getElementById('currentDate').textContent = &#96;${jalali.day} ${monthName} ${jalali.year}&#96;;
-         }
-         displayCurrentDate();
- 
-         // Load dashboard data
-         async function loadDashboard() {
-             console.log('Loading dashboard, API_BASE:', API_BASE);
-             
-             // Get current Jalali month/year
-             const now = new Date();
-             const jalali = gregorianToJalali(now.getFullYear(), now.getMonth() + 1, now.getDate());
-             const month = jalali.month;
-             const year = jalali.year;
-             console.log('Current Jalali date:', year, month);
- 
-             // Total students
-             try {
-                 const studentsRes = await fetch(API_BASE + 'students.php');
-                 const studentsData = await studentsRes.json();
-                 console.log('Students response:', studentsData);
-                 if (studentsData.success) {
-                     document.getElementById('totalStudents').textContent = formatNumber(studentsData.data.pagination.total);
-                 } else {
-                     document.getElementById('totalStudents').textContent = 'Û°';
-                 }
-             } catch (error) {
-                 console.error('Error loading total students:', error);
-                 document.getElementById('totalStudents').textContent = 'Ø®Ø·Ø§';
-             }
- 
-             // Active students this month
-             try {
-                 const activeRes = await fetch(API_BASE + 'students.php?status=active');
-                 const activeData = await activeRes.json();
-                 console.log('Active students response:', activeData);
-                 if (activeData.success) {
-                     document.getElementById('activeStudents').textContent = formatNumber(activeData.data.pagination.total);
-                 } else {
-                     document.getElementById('activeStudents').textContent = 'Û°';
-                 }
-             } catch (error) {
-                 console.error('Error loading active students:', error);
-                 document.getElementById('activeStudents').textContent = 'Ø®Ø·Ø§';
-             }
- 
-             // Net income
-             try {
-                 const netIncomeRes = await fetch(API_BASE + &#96;accounting.php?action=net-income&amp;month=${month}&amp;year=${year}&#96;);
-                 const netIncomeData = await netIncomeRes.json();
-                 console.log('Net income response:', netIncomeData);
-                 if (netIncomeData.success) {
-                     document.getElementById('totalRevenue').textContent = formatNumber(netIncomeData.data.total_income);
-                     document.getElementById('totalExpenses').textContent = formatNumber(netIncomeData.data.total_expenses);
-                     document.getElementById('netIncome').textContent = formatNumber(netIncomeData.data.net_income);
-                 } else {
-                     document.getElementById('totalRevenue').textContent = 'Û°';
-                     document.getElementById('totalExpenses').textContent = 'Û°';
-                     document.getElementById('netIncome').textContent = 'Û°';
-                 }
-             } catch (error) {
-                 console.error('Error loading net income:', error);
-                 document.getElementById('totalRevenue').textContent = 'Ø®Ø·Ø§';
-                 document.getElementById('totalExpenses').textContent = 'Ø®Ø·Ø§';
-                 document.getElementById('netIncome').textContent = 'Ø®Ø·Ø§';
-             }
- 
-             // Expiring students
-             try {
-                 const expiringRes = await fetch(API_BASE + 'students.php?action=expiring');
-                 const expiringData = await expiringRes.json();
-                 console.log('Expiring students response:', expiringData);
-                 if (expiringData.success) {
-                     document.getElementById('expiringCount').textContent = formatNumber(expiringData.data.length);
-                     
-                     const alertsContainer = document.getElementById('alertsContainer');
-                     if (expiringData.data.length &gt; 0) {
-                         alertsContainer.innerHTML = expiringData.data.slice(0, 5).map(s =&gt; &#96;
-                             &lt;div class="alert-app alert-app--warning mb-3"&gt;
-                                 &lt;i class="bi bi-exclamation-circle alert-app-icon"&gt;&lt;/i&gt;
-                                 &lt;div class="alert-app-content"&gt;
-                                     &lt;div class="alert-app-title"&gt;${s.first_name} ${s.last_name}&lt;/div&gt;
-                                     &lt;div&gt;ØªÙ…Ø¯ÛŒØ¯ ØªØ§ ${formatJalaliDate(s.end_date_jalali)}&lt;/div&gt;
-                                 &lt;/div&gt;
-                                 &lt;a href="student-detail.html?id=${s.id}" class="btn-app btn-app--warning btn-app--sm"&gt;
-                                     ØªÙ…Ø¯ÛŒØ¯
-                                 &lt;/a&gt;
-                             &lt;/div&gt;
-                         &#96;).join('');
-                     } else {
-                         alertsContainer.innerHTML = &#96;
-                             &lt;div class="alert-app alert-app--success"&gt;
-                                 &lt;i class="bi bi-check-circle alert-app-icon"&gt;&lt;/i&gt;
-                                 &lt;div class="alert-app-content"&gt;
-                                     Ù‡ÛŒÚ† Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²ÛŒ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ ØªÙ…Ø¯ÛŒØ¯ Ù†ÛŒØ³Øª
-                                 &lt;/div&gt;
-                             &lt;/div&gt;
-                         &#96;;
-                     }
-                 } else {
-                     document.getElementById('expiringCount').textContent = 'Û°';
-                 }
-             } catch (error) {
-                 console.error('Error loading expiring students:', error);
-                 document.getElementById('expiringCount').textContent = 'Ø®Ø·Ø§';
-                 document.getElementById('alertsContainer').innerHTML = &#96;
-                     &lt;div class="alert-app alert-app--danger"&gt;
-                         &lt;i class="bi bi-x-circle alert-app-icon"&gt;&lt;/i&gt;
-                         &lt;div class="alert-app-content"&gt;
-                             Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª. Ù„Ø·ÙØ§Ù‹ ØµÙØ­Ù‡ Ø±Ø§ Ø±ÙØ±Ø´ Ú©Ù†ÛŒØ¯.
-                         &lt;/div&gt;
-                     &lt;/div&gt;
-                 &#96;;
-             }
-         }
- 
-         function formatNumber(num) {
-             return new Intl.NumberFormat('fa-IR').format(num);
-         }
- 
-         function logout() {
-             fetch(API_BASE + 'auth.php?action=logout', { method: 'POST' })
-                 .then(() =&gt; {
-                     localStorage.removeItem('user');
-                     window.location.href = 'login.html';
-                 });
-         }
- 
-         // Mobile sidebar toggle
-         const mobileMenuToggle = document.getElementById('mobileMenuToggle');
-         const sidebar = document.getElementById('sidebar');
-         const sidebarOverlay = document.getElementById('sidebarOverlay');
- 
-         if (mobileMenuToggle) {
-             mobileMenuToggle.addEventListener('click', () =&gt; {
-                 sidebar.classList.toggle('show');
-                 sidebarOverlay.classList.toggle('show');
-             });
-         }
- 
-         if (sidebarOverlay) {
-             sidebarOverlay.addEventListener('click', () =&gt; {
-                 sidebar.classList.remove('show');
-                 sidebarOverlay.classList.remove('show');
-             });
-         }
- 
-         // Initialize
-         loadDashboard();
-         initDarkMode();
-     &lt;/script&gt;
- &lt;/body&gt;
- &lt;/html&gt;
- 
+     &lt;!-- Chart.js --&gt;
+     &lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;
+ &lt;/head&gt;
+ &lt;body&gt;
+     &lt;!-- Navigation --&gt;
+     &lt;nav class="navbar-app"&gt;
+         &lt;a class="navbar-brand" href="index.html"&gt;
+             &lt;span class="navbar-brand-icon"&gt;ğŸ¤¸â€â™‚ï¸&lt;/span&gt;
+             Ú©Ù…Ù¾ Ø®Ø±Ø§Ø³Ø§Ù†
+         &lt;/a&gt;
+         
+         &lt;ul class="navbar-nav-app"&gt;
+             &lt;li&gt;&lt;a class="nav-link-app active" href="index.html"&gt;Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯&lt;/a&gt;&lt;/li&gt;
+             &lt;li&gt;&lt;a class="nav-link-app" href="students.html"&gt;Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†&lt;/a&gt;&lt;/li&gt;
+             &lt;li&gt;&lt;a class="nav-link-app" href="coaches.html"&gt;Ù…Ø±Ø¨ÛŒØ§Ù†&lt;/a&gt;&lt;/li&gt;
+             &lt;li&gt;&lt;a class="nav-link-app" href="expenses.html"&gt;Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§&lt;/a&gt;&lt;/li&gt;
+             &lt;li&gt;&lt;a class="nav-link-app" href="rent.html"&gt;Ø§Ø¬Ø§Ø±Ù‡&lt;/a&gt;&lt;/li&gt;
+             &lt;li&gt;&lt;a class="nav-link-app" href="accounting.html"&gt;Ø¯Ø±Ø¢Ù…Ø¯ Ø®Ø§Ù„Øµ&lt;/a&gt;&lt;/li&gt;
+             &lt;li&gt;&lt;a class="nav-link-app" href="reports.html"&gt;Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§&lt;/a&gt;&lt;/li&gt;
+             &lt;li id="adminNavItem" style="display: none;"&gt;
+                 &lt;a class="nav-link-app" href="admin.html"&gt;Ù…Ø¯ÛŒØ±&lt;/a&gt;
+             &lt;/li&gt;
+         &lt;/ul&gt;
+         
+         &lt;div class="navbar-actions"&gt;
+             &lt;!-- Theme Toggle Switch --&gt;
+             &lt;button type="button" class="theme-switch" id="themeSwitch" title="ØªØºÛŒÛŒØ± ØªÙ…"&gt;
+                 &lt;span class="theme-switch-icons"&gt;
+                     &lt;span class="theme-switch-icon theme-switch-icon--sun"&gt;â˜€ï¸&lt;/span&gt;
+                     &lt;span class="theme-switch-icon theme-switch-icon--moon"&gt;ğŸŒ™&lt;/span&gt;
+                 &lt;/span&gt;
+                 &lt;span class="theme-switch-slider"&gt;&lt;/span&gt;
+             &lt;/button&gt;
+             
+             &lt;!-- User Info --&gt;
+             &lt;div class="navbar-user"&gt;
+                 &lt;span class="navbar-user-icon"&gt;&lt;i class="bi bi-person"&gt;&lt;/i&gt;&lt;/span&gt;
+                 &lt;span id="userName"&gt;&lt;/span&gt;
+             &lt;/div&gt;
+             
+             &lt;!-- Logout --&gt;
+             &lt;button class="navbar-logout" onclick="logout()"&gt;
+                 &lt;i class="bi bi-box-arrow-right"&gt;&lt;/i&gt;
+                 &lt;span&gt;Ø®Ø±ÙˆØ¬&lt;/span&gt;
+             &lt;/button&gt;
+         &lt;/div&gt;
+         
+         &lt;!-- Mobile Menu Toggle --&gt;
+         &lt;button class="navbar-mobile-toggle" id="mobileMenuToggle"&gt;
+             &lt;i class="bi bi-list"&gt;&lt;/i&gt;
+         &lt;/button&gt;
+     &lt;/nav&gt;
+ 
+     &lt;!-- Sidebar --&gt;
+     &lt;aside class="sidebar-app" id="sidebar"&gt;
+         &lt;nav class="sidebar-nav"&gt;
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="index.html" class="sidebar-nav-link active"&gt;
+                     &lt;i class="bi bi-grid-1x2 sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             
+             &lt;div class="sidebar-section-title"&gt;Ù…Ø¯ÛŒØ±ÛŒØª&lt;/div&gt;
+             
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="students.html" class="sidebar-nav-link"&gt;
+                     &lt;i class="bi bi-people sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="students.html?tab=new" class="sidebar-nav-link"&gt;
+                     &lt;i class="bi bi-person-plus sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ø«Ø¨Øª Ø¬Ø¯ÛŒØ¯
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="coaches.html" class="sidebar-nav-link"&gt;
+                     &lt;i class="bi bi-person-badge sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ù…Ø±Ø¨ÛŒØ§Ù†
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             
+             &lt;div class="sidebar-section-title"&gt;Ù…Ø§Ù„ÛŒ&lt;/div&gt;
+             
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="expenses.html" class="sidebar-nav-link"&gt;
+                     &lt;i class="bi bi-cash-stack sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="rent.html" class="sidebar-nav-link"&gt;
+                     &lt;i class="bi bi-house sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ø§Ø¬Ø§Ø±Ù‡
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="accounting.html" class="sidebar-nav-link"&gt;
+                     &lt;i class="bi bi-calculator sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ø¯Ø±Ø¢Ù…Ø¯ Ø®Ø§Ù„Øµ
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="reports.html" class="sidebar-nav-link"&gt;
+                     &lt;i class="bi bi-bar-chart sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             
+             &lt;div class="sidebar-section-title"&gt;Ø³ÛŒØ³ØªÙ…&lt;/div&gt;
+             
+             &lt;div class="sidebar-nav-item" id="adminSidebarItem" style="display: none;"&gt;
+                 &lt;a href="admin.html" class="sidebar-nav-link"&gt;
+                     &lt;i class="bi bi-gear sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ù…Ø¯ÛŒØ±
+                 &lt;/a&gt;
+             &lt;/div&gt;
+             &lt;div class="sidebar-nav-item"&gt;
+                 &lt;a href="#" class="sidebar-nav-link" onclick="logout()"&gt;
+                     &lt;i class="bi bi-box-arrow-right sidebar-nav-icon"&gt;&lt;/i&gt;
+                     Ø®Ø±ÙˆØ¬
+                 &lt;/a&gt;
+             &lt;/div&gt;
+         &lt;/nav&gt;
+     &lt;/aside&gt;
+ 
+     &lt;!-- Main Content --&gt;
+     &lt;main class="app-main"&gt;
+         &lt;div class="container-app"&gt;
+             &lt;!-- Page Header --&gt;
+             &lt;div class="flex items-center justify-between mb-6"&gt;
+                 &lt;div&gt;
+                     &lt;h1 class="page-title mb-1"&gt;Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯&lt;/h1&gt;
+                     &lt;div class="text-secondary" id="currentDate"&gt;&lt;/div&gt;
+                 &lt;/div&gt;
+                 &lt;div class="flex gap-2"&gt;
+                     &lt;button class="btn-app btn-app--secondary btn-app--sm" onclick="loadDashboard()"&gt;
+                         &lt;i class="bi bi-arrow-clockwise"&gt;&lt;/i&gt;
+                         Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
+                     &lt;/button&gt;
+                 &lt;/div&gt;
+             &lt;/div&gt;
+ 
+             &lt;!-- KPI Cards Row --&gt;
+             &lt;div class="row g-4 mb-6"&gt;
+                 &lt;!-- Total Students --&gt;
+                 &lt;div class="col-sm-6 col-xl-3"&gt;
+                     &lt;div class="kpi-card kpi-card--primary animate-slideUp"&gt;
+                         &lt;div class="flex justify-between items-start"&gt;
+                             &lt;div&gt;
+                                 &lt;div class="kpi-card-value" id="totalStudents"&gt;
+                                     &lt;div class="skeleton skeleton-title" style="width: 60px;"&gt;&lt;/div&gt;
+                                 &lt;/div&gt;
+                                 &lt;div class="kpi-card-label"&gt;Ú©Ù„ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†&lt;/div&gt;
+                             &lt;/div&gt;
+                             &lt;div class="kpi-card-icon mb-0"&gt;
+                                 &lt;i class="bi bi-people"&gt;&lt;/i&gt;
+                             &lt;/div&gt;
+                         &lt;/div&gt;
+                         &lt;div class="mt-3"&gt;
+                             &lt;a href="students.html" class="kpi-card-link"&gt;Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„ÛŒØ³Øª&lt;/a&gt;
+                         &lt;/div&gt;
+                     &lt;/div&gt;
+                 &lt;/div&gt;
+                 
+                 &lt;!-- Active Students --&gt;
+                 &lt;div class="col-sm-6 col-xl-3"&gt;
+                     &lt;div class="kpi-card kpi-card--success animate-slideUp" style="animation-delay: 50ms;"&gt;
+                         &lt;div class="flex justify-between items-start"&gt;
+                             &lt;div&gt;
+                                 &lt;div class="kpi-card-value" id="activeStudents"&gt;
+                                     &lt;div class="skeleton skeleton-title" style="width: 60px;"&gt;&lt;/div&gt;
+                                 &lt;/div&gt;
+                                 &lt;div class="kpi-card-label"&gt;Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† ÙØ¹Ø§Ù„&lt;/div&gt;
+                             &lt;/div&gt;
+                             &lt;div class="kpi-card-icon mb-0"&gt;
+                                 &lt;i class="bi bi-person-check"&gt;&lt;/i&gt;
+                             &lt;/div&gt;
+                         &lt;/div&gt;
+                         &lt;div class="mt-3 text-secondary" style="font-size: 0.8rem;"&gt;
+                             Ø¯Ø± Ù…Ø§Ù‡ Ø¬Ø§Ø±ÛŒ
+                         &lt;/div&gt;
+                     &lt;/div&gt;
+                 &lt;/div&gt;
+                 
+                 &lt;!-- Monthly Revenue --&gt;
+                 &lt;div class="col-sm-6 col-xl-3"&gt;
+                     &lt;div class="kpi-card kpi-card--info animate-slideUp" style="animation-delay: 100ms;"&gt;
+                         &lt;div class="flex justify-between items-start"&gt;
+                             &lt;div&gt;
+                                 &lt;div class="kpi-card-value" id="monthlyRevenue"&gt;
+                                     &lt;div class="skeleton skeleton-title" style="width: 80px;"&gt;&lt;/div&gt;
+                                 &lt;/div&gt;
+                                 &lt;div class="kpi-card-label"&gt;Ø¯Ø±Ø¢Ù…Ø¯ Ø§ÛŒÙ† Ù…Ø§Ù‡ (Ø§ÙØºØ§Ù†ÛŒ)&lt;/div&gt;
+                             &lt;/div&gt;
+                             &lt;div class="kpi-card-icon mb-0"&gt;
+                                 &lt;i class="bi bi-cash-coin"&gt;&lt;/i&gt;
+                             &lt;/div&gt;
+                         &lt;/div&gt;
+                         &lt;div class="mt-3 text-secondary" style="font-size: 0.8rem;"&gt;
+                             Ø¨Ø¯ÙˆÙ† Ú©Ø³Ø± Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
+                         &lt;/div&gt;
+                     &lt;/div&gt;
+                 &lt;/div&gt;
+                 
+                 &lt;!-- Net Income --&gt;
+                 &lt;div class="col-sm-6 col-xl-3"&gt;
+                     &lt;div class="kpi-card kpi-card--dark animate-slideUp" style="animation-delay: 150ms;"&gt;
+                         &lt;div class="flex justify-between items-start"&gt;
+                             &lt;div&gt;
+                                 &lt;div class="kpi-card-value" id="netIncome"&gt;
+                                     &lt;div class="skeleton skeleton-title" style="width: 80px;"&gt;&lt;/div&gt;
+                                 &lt;/div&gt;
+                                 &lt;div class="kpi-card-label"&gt;Ø³ÙˆØ¯ Ø®Ø§Ù„Øµ Ø§ÛŒÙ† Ù…Ø§Ù‡&lt;/div&gt;
+                             &lt;/div&gt;
+                             &lt;div class="kpi-card-icon mb-0"&gt;
+                                 &lt;i class="bi bi-graph-up-arrow"&gt;&lt;/i&gt;
+                             &lt;/div&gt;
+                         &lt;/div&gt;
+                         &lt;div class="mt-3"&gt;
+                             &lt;a href="accounting.html" class="kpi-card-link"&gt;Ø¬Ø²Ø¦ÛŒØ§Øª Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ&lt;/a&gt;
+                         &lt;/div&gt;
+                     &lt;/div&gt;
+                 &lt;/div&gt;
+             &lt;/div&gt;
+ 
+             &lt;!-- Analytics &amp; Actions Row --&gt;
+             &lt;div class="row g-4 mb-6"&gt;
+                 &lt;!-- Financial Trend Chart --&gt;
+                 &lt;div class="col-lg-8"&gt;
+                     &lt;div class="card-app h-100 animate-slideUp" style="animation-delay: 200ms;"&gt;
+                         &lt;div class="card-app-header"&gt;
+                             &lt;h2 class="card-app-title"&gt;
+                                 &lt;i class="bi bi-bar-chart-line"&gt;&lt;/i&gt;
+                                 Ù†Ù…ÙˆØ¯Ø§Ø± Ù…Ø§Ù„ÛŒ Ù…Ø§Ù‡ Ø¬Ø§Ø±ÛŒ
+                             &lt;/h2&gt;
+                         &lt;/div&gt;
+                         &lt;div class="card-app-body"&gt;
+                             &lt;div style="height: 300px; position: relative;"&gt;
+                                 &lt;canvas id="financialChart"&gt;&lt;/canvas&gt;
+                             &lt;/div&gt;
+                         &lt;/div&gt;
+                     &lt;/div&gt;
+                 &lt;/div&gt;
+                 
+                 &lt;!-- Quick Actions --&gt;
+                 &lt;div class="col-lg-4"&gt;
+                     &lt;div class="card-app h-100 animate-slideUp" style="animation-delay: 250ms;"&gt;
+                         &lt;div class="card-app-header"&gt;
+                             &lt;h2 class="card-app-title"&gt;
+                                 &lt;i class="bi bi-lightning-charge"&gt;&lt;/i&gt;
+                                 Ø¯Ø³ØªØ±Ø³ÛŒ Ø³Ø±ÛŒØ¹
+                             &lt;/h2&gt;
+                         &lt;/div&gt;
+                         &lt;div class="card-app-body"&gt;
+                             &lt;div class="d-grid gap-3"&gt;
+                                 &lt;a href="students.html?tab=new" class="btn-app btn-app--primary btn-app--lg justify-content-start"&gt;
+                                     &lt;i class="bi bi-person-plus ms-2"&gt;&lt;/i&gt;
+                                     Ø«Ø¨Øª Ù†Ø§Ù… Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø¬Ø¯ÛŒØ¯
+                                 &lt;/a&gt;
+                                 &lt;a href="expenses.html" class="btn-app btn-app--warning btn-app--lg justify-content-start"&gt;
+                                     &lt;i class="bi bi-cash-stack ms-2"&gt;&lt;/i&gt;
+                                     Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡ Ø¬Ø¯ÛŒØ¯
+                                 &lt;/a&gt;
+                                 &lt;a href="coaches.html" class="btn-app btn-app--success btn-app--lg justify-content-start"&gt;
+                                     &lt;i class="bi bi-person-badge ms-2"&gt;&lt;/i&gt;
+                                     Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø±Ø¨ÛŒØ§Ù†
+                                 &lt;/a&gt;
+                                 &lt;a href="accounting.html" class="btn-app btn-app--secondary btn-app--lg justify-content-start"&gt;
+                                     &lt;i class="bi bi-calculator ms-2"&gt;&lt;/i&gt;
+                                     Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø­Ù‚ÙˆÙ‚ Ùˆ Ø¯Ø±Ø¢Ù…Ø¯
+                                 &lt;/a&gt;
+                             &lt;/div&gt;
+                         &lt;/div&gt;
+                     &lt;/div&gt;
+                 &lt;/div&gt;
+             &lt;/div&gt;
+ 
+             &lt;!-- Activity Row --&gt;
+             &lt;div class="row g-4"&gt;
+                 &lt;!-- Recent Registrations --&gt;
+                 &lt;div class="col-lg-6"&gt;
+                     &lt;div class="card-app animate-slideUp" style="animation-delay: 300ms;"&gt;
+                         &lt;div class="card-app-header"&gt;
+                             &lt;h2 class="card-app-title"&gt;
+                                 &lt;i class="bi bi-clock-history"&gt;&lt;/i&gt;
+                                 Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…â€ŒÙ‡Ø§ÛŒ Ø§Ø®ÛŒØ±
+                             &lt;/h2&gt;
+                             &lt;a href="reports.html" class="btn-app btn-app--ghost btn-app--sm"&gt;Ù‡Ù…Ù‡ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§&lt;/a&gt;
+                         &lt;/div&gt;
+                         &lt;div class="card-app-body p-0"&gt;
+                             &lt;div class="table-responsive"&gt;
+                                 &lt;table class="table-app table-striped mb-0"&gt;
+                                     &lt;thead class="bg-light"&gt;
+                                         &lt;tr&gt;
+                                             &lt;th class="ps-4"&gt;Ù†Ø§Ù… Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²&lt;/th&gt;
+                                             &lt;th&gt;Ù…Ø¨Ù„Øº (Ø§ÙØºØ§Ù†ÛŒ)&lt;/th&gt;
+                                             &lt;th&gt;ØªØ§Ø±ÛŒØ®&lt;/th&gt;
+                                             &lt;th class="text-end pe-4"&gt;ÙˆØ¶Ø¹ÛŒØª&lt;/th&gt;
+                                         &lt;/tr&gt;
+                                     &lt;/thead&gt;
+                                     &lt;tbody id="recentRegistrationsTable"&gt;
+                                         &lt;tr&gt;
+                                             &lt;td colspan="4" class="text-center py-4"&gt;
+                                                 &lt;div class="skeleton skeleton-text w-75 mx-auto"&gt;&lt;/div&gt;
+                                                 &lt;div class="skeleton skeleton-text w-50 mx-auto"&gt;&lt;/div&gt;
+                                             &lt;/td&gt;
+                                         &lt;/tr&gt;
+                                     &lt;/tbody&gt;
+                                 &lt;/table&gt;
+                             &lt;/div&gt;
+                         &lt;/div&gt;
+                     &lt;/div&gt;
+                 &lt;/div&gt;
+                 
+                 &lt;!-- Expiring Students --&gt;
+                 &lt;div class="col-lg-6"&gt;
+                     &lt;div class="card-app animate-slideUp" style="animation-delay: 350ms;"&gt;
+                         &lt;div class="card-app-header border-bottom-0 pb-0"&gt;
+                             &lt;h2 class="card-app-title text-danger"&gt;
+                                 &lt;i class="bi bi-exclamation-triangle"&gt;&lt;/i&gt;
+                                 Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ ØªÙ…Ø¯ÛŒØ¯ (Û· Ø±ÙˆØ² Ø¢ÛŒÙ†Ø¯Ù‡)
+                             &lt;/h2&gt;
+                             &lt;span class="badge-app badge-app--danger" id="expiringCountBadge"&gt;0&lt;/span&gt;
+                         &lt;/div&gt;
+                         &lt;div class="card-app-body" id="expiringStudentsList"&gt;
+                             &lt;div class="skeleton skeleton-text mb-3"&gt;&lt;/div&gt;
+                             &lt;div class="skeleton skeleton-text mb-3"&gt;&lt;/div&gt;
+                             &lt;div class="skeleton skeleton-text"&gt;&lt;/div&gt;
+                         &lt;/div&gt;
+                         &lt;div class="card-app-footer text-center"&gt;
+                             &lt;a href="students.html?tab=expiring" class="btn-app btn-app--ghost btn-app--sm text-danger"&gt;
+                                 Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ù…Ù‡ Ù…ÙˆØ§Ø±Ø¯
+                             &lt;/a&gt;
+                         &lt;/div&gt;
+                     &lt;/div&gt;
+                 &lt;/div&gt;
+             &lt;/div&gt;
+ 
+         &lt;/div&gt;
+     &lt;/main&gt;
+ 
+     &lt;!-- Mobile Sidebar Overlay --&gt;
+     &lt;div class="sidebar-overlay" id="sidebarOverlay"&gt;&lt;/div&gt;
+ 
+     &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
+     &lt;script src="js/app.js"&gt;&lt;/script&gt;
+     &lt;script src="js/jalali.js?v=2"&gt;&lt;/script&gt;
+     &lt;script&gt;
+         // Check authentication
+         const user = JSON.parse(localStorage.getItem('user') || 'null');
+         if (!user) {
+             window.location.href = 'login.html';
+         } else {
+             document.getElementById('userName').textContent = user.username;
+             // Show Admin tab if user is admin
+             if (user.role === 'admin') {
+                 document.getElementById('adminNavItem').style.display = 'block';
+                 document.getElementById('adminSidebarItem').style.display = 'block';
+             }
+         }
+ 
+         // Display current Jalali date
+         function displayCurrentDate() {
+             const now = new Date();
+             const jalali = gregorianToJalali(now.getFullYear(), now.getMonth() + 1, now.getDate());
+             const monthNames = ['Ø­Ù…Ù„', 'Ø«ÙˆØ±', 'Ø¬ÙˆØ²Ø§', 'Ø³Ø±Ø·Ø§Ù†', 'Ø§Ø³Ø¯', 'Ø³Ù†Ø¨Ù„Ù‡', 'Ù…ÛŒØ²Ø§Ù†', 'Ø¹Ù‚Ø±Ø¨', 'Ù‚ÙˆØ³', 'Ø¬Ø¯ÛŒ', 'Ø¯Ù„Ùˆ', 'Ø­ÙˆØª'];
+             const monthName = monthNames[jalali.month - 1];
+             document.getElementById('currentDate').textContent = &#96;${jalali.day} ${monthName} ${jalali.year}&#96;;
+             return jalali;
+         }
+         
+         const currentJalali = displayCurrentDate();
+         let financialChartInstance = null;
+ 
+         // Load dashboard data
+         async function loadDashboard() {
+             console.log('Loading dashboard data...');
+             
+             // 1. Load KPI Counts
+             loadKPICounts();
+             
+             // 2. Load Financial Data (KPIs + Chart + Recent)
+             loadFinancialData();
+             
+             // 3. Load Expiring Students
+             loadExpiringStudents();
+         }
+ 
+         async function loadKPICounts() {
+             try {
+                 // Total Students
+                 const studentsRes = await fetch(API_BASE + 'students.php');
+                 const studentsData = await studentsRes.json();
+                 if (studentsData.success) {
+                     document.getElementById('totalStudents').textContent = formatNumber(studentsData.data.pagination.total);
+                 }
+ 
+                 // Active Students
+                 const activeRes = await fetch(API_BASE + 'students.php?status=active');
+                 const activeData = await activeRes.json();
+                 if (activeData.success) {
+                     document.getElementById('activeStudents').textContent = formatNumber(activeData.data.pagination.total);
+                 }
+             } catch (error) {
+                 console.error('Error loading student counts:', error);
+             }
+         }
+ 
+         async function loadFinancialData() {
+             const month = currentJalali.month;
+             const year = currentJalali.year;
+             
+             try {
+                 // Get Breakdown for Chart and Recents
+                 const breakdownRes = await fetch(API_BASE + &#96;accounting.php?action=breakdown&amp;month=${month}&amp;year=${year}&#96;);
+                 const breakdownData = await breakdownRes.json();
+                 
+                 if (breakdownData.success) {
+                     const income = breakdownData.data.income || [];
+                     const expenses = breakdownData.data.expenses || [];
+                     
+                     // Render Chart
+                     renderFinancialChart(income, expenses, month);
+                     
+                     // Render Recent Registrations
+                     renderRecentRegistrations(income);
+                     
+                     // Calculate totals from this data for consistency
+                     const totalIncome = income.reduce((sum, item) =&gt; sum + parseFloat(item.fee_amount || 0), 0);
+                     const totalExpenses = expenses.reduce((sum, item) =&gt; sum + parseFloat(item.amount || 0), 0);
+                     const net = totalIncome - totalExpenses;
+                     
+                     document.getElementById('monthlyRevenue').textContent = formatNumber(totalIncome);
+                     document.getElementById('netIncome').textContent = formatNumber(net);
+                     
+                     // Color code net income
+                     const netEl = document.getElementById('netIncome');
+                     if (net &lt; 0) netEl.classList.add('text-danger');
+                     else netEl.classList.remove('text-danger');
+                 }
+             } catch (error) {
+                 console.error('Error loading financial data:', error);
+             }
+         }
+ 
+         function renderFinancialChart(incomeData, expenseData, currentMonth) {
+             const ctx = document.getElementById('financialChart').getContext('2d');
+             
+             // Destroy previous instance if exists
+             if (financialChartInstance) {
+                 financialChartInstance.destroy();
+             }
+ 
+             // Group data by day
+             const daysInMonth = currentMonth &lt;= 6 ? 31 : (currentMonth &lt;= 11 ? 30 : 29); // Simplified
+             const labels = Array.from({length: daysInMonth}, (_, i) =&gt; i + 1);
+             
+             const incomeByDay = new Array(daysInMonth).fill(0);
+             const expenseByDay = new Array(daysInMonth).fill(0);
+ 
+             incomeData.forEach(item =&gt; {
+                 if (item.registration_date_jalali) {
+                     const day = parseInt(item.registration_date_jalali.split('-')[2]);
+                     if (day &gt;= 1 &amp;&amp; day &lt;= daysInMonth) {
+                         incomeByDay[day - 1] += parseFloat(item.fee_amount);
+                     }
+                 }
+             });
+ 
+             expenseData.forEach(item =&gt; {
+                 if (item.expense_date_jalali) {
+                     const day = parseInt(item.expense_date_jalali.split('-')[2]);
+                     if (day &gt;= 1 &amp;&amp; day &lt;= daysInMonth) {
+                         expenseByDay[day - 1] += parseFloat(item.amount);
+                     }
+                 }
+             });
+             
+             // Check for dark mode
+             const isDarkMode = document.documentElement.getAttribute('data-theme') === 'dark';
+             const textColor = isDarkMode ? '#cbd5e1' : '#64748b';
+             const gridColor = isDarkMode ? '#334155' : '#e2e8f0';
+ 
+             financialChartInstance = new Chart(ctx, {
+                 type: 'line',
+                 data: {
+                     labels: labels,
+                     datasets: [
+                         {
+                             label: 'Ø¯Ø±Ø¢Ù…Ø¯',
+                             data: incomeByDay,
+                             borderColor: '#10b981',
+                             backgroundColor: 'rgba(16, 185, 129, 0.1)',
+                             borderWidth: 2,
+                             tension: 0.4,
+                             fill: true,
+                             pointRadius: 2
+                         },
+                         {
+                             label: 'Ù‡Ø²ÛŒÙ†Ù‡',
+                             data: expenseByDay,
+                             borderColor: '#ef4444',
+                             backgroundColor: 'rgba(239, 68, 68, 0.1)',
+                             borderWidth: 2,
+                             tension: 0.4,
+                             fill: true,
+                             pointRadius: 2
+                         }
+                     ]
+                 },
+                 options: {
+                     responsive: true,
+                     maintainAspectRatio: false,
+                     plugins: {
+                         legend: {
+                             position: 'top',
+                             labels: {
+                                 font: { family: 'Vazirmatn' },
+                                 color: textColor
+                             }
+                         },
+                         tooltip: {
+                             titleFont: { family: 'Vazirmatn' },
+                             bodyFont: { family: 'Vazirmatn' }
+                         }
+                     },
+                     scales: {
+                         x: {
+                             grid: { display: false, color: gridColor },
+                             ticks: { font: { family: 'Vazirmatn' }, color: textColor }
+                         },
+                         y: {
+                             grid: { borderDash: [2, 4], color: gridColor },
+                             ticks: { 
+                                 font: { family: 'Vazirmatn' },
+                                 color: textColor,
+                                 callback: function(value) {
+                                     return new Intl.NumberFormat('fa-IR').format(value);
+                                 }
+                             }
+                         }
+                     },
+                     interaction: {
+                         intersect: false,
+                         mode: 'index',
+                     },
+                 }
+             });
+         }
+ 
+         function renderRecentRegistrations(registrations) {
+             const tbody = document.getElementById('recentRegistrationsTable');
+             
+             // Take top 5
+             const recent = registrations.slice(0, 5);
+             
+             if (recent.length === 0) {
+                 tbody.innerHTML = &#96;
+                     &lt;tr&gt;
+                         &lt;td colspan="4" class="text-center py-4 text-muted"&gt;
+                             Ù‡Ù†ÙˆØ² Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…ÛŒ Ø¯Ø± Ø§ÛŒÙ† Ù…Ø§Ù‡ Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
+                         &lt;/td&gt;
+                     &lt;/tr&gt;
+                 &#96;;
+                 return;
+             }
+             
+             tbody.innerHTML = recent.map(reg =&gt; &#96;
+                 &lt;tr&gt;
+                     &lt;td class="ps-4 fw-medium text-dark"&gt;${reg.first_name} ${reg.last_name}&lt;/td&gt;
+                     &lt;td class="text-success fw-bold"&gt;${formatNumber(reg.fee_amount)}&lt;/td&gt;
+                     &lt;td class="text-secondary small" dir="ltr"&gt;${reg.registration_date_jalali}&lt;/td&gt;
+                     &lt;td class="text-end pe-4"&gt;
+                         &lt;span class="badge-app badge-app--success"&gt;ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡&lt;/span&gt;
+                     &lt;/td&gt;
+                 &lt;/tr&gt;
+             &#96;).join('');
+         }
+ 
+         async function loadExpiringStudents() {
+             try {
+                 const expiringRes = await fetch(API_BASE + 'students.php?action=expiring');
+                 const expiringData = await expiringRes.json();
+                 
+                 if (expiringData.success) {
+                     const students = expiringData.data;
+                     document.getElementById('expiringCountBadge').textContent = formatNumber(students.length);
+                     
+                     const listContainer = document.getElementById('expiringStudentsList');
+                     
+                     if (students.length === 0) {
+                         listContainer.innerHTML = &#96;
+                             &lt;div class="alert-app alert-app--success mb-0"&gt;
+                                 &lt;i class="bi bi-check-circle alert-app-icon"&gt;&lt;/i&gt;
+                                 &lt;div class="alert-app-content"&gt;
+                                     Ø¹Ø§Ù„ÛŒ! Ù‡ÛŒÚ† Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²ÛŒ Ø¯Ø± Û· Ø±ÙˆØ² Ø¢ÛŒÙ†Ø¯Ù‡ Ù…Ù†Ù‚Ø¶ÛŒ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯.
+                                 &lt;/div&gt;
+                             &lt;/div&gt;
+                         &#96;;
+                     } else {
+                         // Show top 3
+                         listContainer.innerHTML = students.slice(0, 3).map(s =&gt; &#96;
+                             &lt;div class="flex items-center justify-between p-3 border rounded-3 mb-2 bg-white hover-bg-gray-50 transition-base"&gt;
+                                 &lt;div class="flex items-center gap-3"&gt;
+                                     &lt;div class="width-40 height-40 rounded-circle bg-danger-50 text-danger flex items-center justify-center"&gt;
+                                         &lt;i class="bi bi-hourglass-split"&gt;&lt;/i&gt;
+                                     &lt;/div&gt;
+                                     &lt;div&gt;
+                                         &lt;div class="fw-bold text-dark"&gt;${s.first_name} ${s.last_name}&lt;/div&gt;
+                                         &lt;div class="text-xs text-secondary mt-1"&gt;
+                                             Ù¾Ø§ÛŒØ§Ù†: &lt;span class="fw-medium text-danger"&gt;${s.end_date_jalali}&lt;/span&gt;
+                                         &lt;/div&gt;
+                                     &lt;/div&gt;
+                                 &lt;/div&gt;
+                                 &lt;a href="student-detail.html?id=${s.id}" class="btn-app btn-app--sm btn-app--secondary"&gt;
+                                     ØªÙ…Ø¯ÛŒØ¯
+                                 &lt;/a&gt;
+                             &lt;/div&gt;
+                         &#96;).join('');
+                     }
+                 }
+             } catch (error) {
+                 console.error('Error loading expiring students:', error);
+             }
+         }
+ 
+         function formatNumber(num) {
+             return new Intl.NumberFormat('fa-IR').format(num);
+         }
+ 
+         function logout() {
+             fetch(API_BASE + 'auth.php?action=logout', { method: 'POST' })
+                 .then(() =&gt; {
+                     localStorage.removeItem('user');
+                     window.location.href = 'login.html';
+                 });
+         }
+ 
+         // Mobile sidebar toggle
+         const mobileMenuToggle = document.getElementById('mobileMenuToggle');
+         const sidebar = document.getElementById('sidebar');
+         const sidebarOverlay = document.getElementById('sidebarOverlay');
+ 
+         if (mobileMenuToggle) {
+             mobileMenuToggle.addEventListener('click', () =&gt; {
+                 sidebar.classList.toggle('show');
+                 sidebarOverlay.classList.toggle('show');
+             });
+         }
+ 
+         if (sidebarOverlay) {
+             sidebarOverlay.addEventListener('click', () =&gt; {
+                 sidebar.classList.remove('show');
+                 sidebarOverlay.classList.remove('show');
+             });
+         }
+ 
+         // Initialize
+         loadDashboard();
+         initDarkMode();
+         
+         // Listen for theme changes to update chart
+         document.getElementById('themeSwitch').addEventListener('click', () =&gt; {
+             setTimeout(() =&gt; {
+                 loadFinancialData(); // Re-render chart with new theme colors
+             }, 100);
+         });
+     &lt;/script&gt;
+ &lt;/body&gt;
+ &lt;/html&gt;
+ 
```

</details>

</tool-use>

---

<think><details><summary>Thought Process</summary>
**Considering Restructuring Implementation**

I'm currently working on refactoring the JavaScript, aiming to move it out of `index.html` for better organization. The Chart.js integration is now solid, and I've ensured all the new logic works as intended. I'm exploring ways to modularize the code to improve maintainability before extracting it.


**Analyzing Initial Integration Steps**

I've finished rewriting `public/index.html` with the new structure and integrated Chart.js, incorporating the updated JavaScript logic. This includes fetching and displaying all required data, as well as rendering the chart, recent registrations, and expiring students lists. I'm now verifying the availability and proper use of `initDarkMode` and `API_BASE` within `js/app.js` to ensure compatibility. I just read through `public/js/app.js` and confirmed the global availability of both `API_BASE` and `initDarkMode`.


</details></think>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** â€¢ Read file: public/js/app.js</summary>

</details>
</tool-use>

---

<think><details><summary>Thought Process</summary>
**Confirming Code Structure**

I've just confirmed the presence of `API_BASE` in `public/js/app.js`, which is correctly pointing to the API. I've also verified the exports for `initDarkMode`, `formatNumber`, and `logout`. This all looks promising for the overall architecture.


**Reassessing Project Completion**

I've reviewed `index.html` and confirmed its use of the global `API_BASE` and `initDarkMode`. The local definitions of `formatNumber` and `logout` are also acceptable, and won't break anything. I've now meticulously reviewed the project plan and todos and can definitively confirm all tasks have been completed. It looks like it is done.


**Analyzing Final Implementation**

I've carefully revisited the `index.html` structure and confirmed the correct integration of `API_BASE` and the use of the `initDarkMode` function. The plan is complete. After a final review of the CSS classes, it appears that all the classes I used are from `design-system.css`. I've also verified the use of API calls relative to the correct base in `index.html`. All tasks and todos are complete.


**Evaluating Remaining Details**

I've confirmed the `API_BASE` usage and the implementation of `initDarkMode`. Also, `formatNumber` and `logout` behave as intended. I've re-examined the plan and todos, and all features are complete. Moreover, I've checked the CSS classes and the overall design system compatibility. After checking, I have double-checked the requirements and specific plan details, and everything appears to be implemented.


</details></think>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** â€¢ Todo List</summary>

- [x] Modify public/index.html to implement the new grid layout and include Chart.js
- [x] Update dashboard JavaScript to fetch breakdown data and render the Chart.js chart
- [x] Implement Recent Registrations table and Quick Actions section

</details>
</tool-use>

---

The dashboard redesign has been implemented according to the plan.

### Key Changes:
1.  **Layout**: Switched to a responsive grid layout using Bootstrap 5 and the custom design system.
2.  **Visuals**: Added a **Financial Trend Chart** using Chart.js to visualize Income vs. Expenses over the current month.
3.  **Real Data**:
    *   **KPIs**: Now showing real data for Total Students, Active Students, Monthly Revenue, and Net Income.
    *   **Activity**: Added a "Recent Registrations" table showing the last 5 transactions.
    *   **Alerts**: "Expiring Soon" list now shows students expiring within the next 7 days.
4.  **Quick Actions**: Added a dedicated section for common tasks like registering students or adding expenses.
5.  **Responsiveness**: The layout adapts to different screen sizes, with a mobile-friendly sidebar and navigation.

The new dashboard is now cleaner, more actionable, and showcases real financial and student data. You can refresh the page to see the changes.

---

